<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARCHIKMOR - Timeless Harmony</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,300&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    
    <header class="header" id="header">
        <div class="logo-container">
            <div class="logo-icon">
            <img src="logo.png" alt="ARCHIKMOR logo" class="logo-image">
            </div>
            <div>
                <div class="logo-text">ARCHIKMOR</div>
                <span class="tagline-small">Timeless Harmony</span>
            </div>
        </div>
        
        <button class="mobile-menu-btn" id="mobileMenuBtn">☰</button>
        
        <nav>
            <ul class="nav-menu">
                <li><a href="#home">Home</a></li>
                <li><a href="#planning">Space Planning</a></li>
                <li><a href="#wood">Wood Craft</a></li>
                <li><a href="#catalogue">Catalog</a></li>
                <li><a href="#preview">Preview</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>
    
    <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>
    <div class="mobile-nav" id="mobileNav">
        <button class="mobile-nav-close" id="mobileNavClose">✕</button>
        <ul class="mobile-nav-menu">
            <li><a href="#home" class="mobile-nav-link">Home</a></li>
            <li><a href="#planning" class="mobile-nav-link">Space Planning</a></li>
            <li><a href="#wood" class="mobile-nav-link">Wood Craft</a></li>
            <li><a href="#catalogue" class="mobile-nav-link">Catalog</a></li>
            <li><a href="#preview" class="mobile-nav-link">Preview</a></li>
            <li><a href="#services" class="mobile-nav-link">Services</a></li>
            <li><a href="#contact" class="mobile-nav-link">Contact</a></li>
        </ul>
    </div>

    <section class="hero" id="home">
        <div class="hero-content">
            <h1>ARCHIKMOR</h1>
            <p class="subtitle">Timeless Harmony in Modern Design</p>
            <a href="#catalogue" class="cta-button">Download Catalog</a>
        </div>
    </section>

    <section class="space-planning" id="planning">
        <h2 class="section-title">INTELLIGENT SPACE PLANNING</h2>
        <div class="planning-content">
            <div class="planning-text">
                <h3>Strategic Design for Optimal Living</h3>
                <p>At ARCHIKMOR, we believe that great design begins with intelligent space planning. Our approach transforms ordinary spaces into extraordinary experiences through meticulous analysis and creative solutions.</p>
                
                <p>We consider every aspect of your space - from traffic flow and natural light to functionality and aesthetic harmony - to create environments that work beautifully and feel intuitively right.</p>

                <ul class="planning-features">
                    <li>Customized layout optimization for your specific needs</li>
                    <li>Traffic flow analysis and circulation planning</li>
                    <li>Furniture placement and scale consideration</li>
                    <li>Lighting and electrical planning integration</li>
                    <li>Storage solutions and spatial organization</li>
                    <li>Future-proof design for evolving lifestyles</li>
                </ul>
            </div>
            <div class="planning-image"></div>
        </div>

        <div class="planning-stats">
            <div class="stat-item">
                <div class="stat-number">98%</div>
                <div class="stat-label">Client Satisfaction</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">250+</div>
                <div class="stat-label">Projects Completed</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">30+</div>
                <div class="stat-label">Years Experience</div>
            </div>
        </div>
    </section>

    <section class="wood-showcase" id="wood">
        <h2 class="section-title">WOOD CRAFT & ARCHITECTURE</h2>
        <div class="wood-grid">
            <div class="wood-item">
                <div class="wood-image" style="background-image: url('https://plus.unsplash.com/premium_photo-1661902374603-0e8a4162498f?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1041')"></div>
                <div class="wood-overlay">
                    <h4>Custom Wood Panels</h4>
                    <p>Handcrafted wood panels that bring warmth and natural elegance to any space</p>
                </div>
            </div>
            <div class="wood-item">
                <div class="wood-image" style="background-image: url('https://images.unsplash.com/photo-1684928365167-e91916573122?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8d29vZCUyMGtpdGNoZW58ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=600')"></div>
                <div class="wood-overlay">
                    <h4>Architectural Woodwork</h4>
                    <p>Bespoke wood installations that define the character of modern interiors</p>
                </div>
            </div>
        </div>
    </section>
    <section class="catalogue-preview" id="preview">
        <h2 class="section-title">CATALOG PREVIEW</h2>
        <div class="catalogue-grid">
            <div class="catalogue-item">
                <div class="catalogue-image" style="background-image: url('https://media.istockphoto.com/id/2191829498/photo/wabi-sabi-style-living-room-with-sofa-wicker-chairs-coffee-table-potted-plant-and-parquet.jpg?s=612x612&w=0&k=20&c=eB-HpdGVrS3RvMQpKroW2uKbQshISpkP6eklkl5tOIg=')"></div>
                <div class="catalogue-content">
                    <span class="collection-tag">Living Room Collections</span>
                    <h3>Where Comfort Meets Timeless Design</h3>
                    <p>Discover elegant living spaces with furniture crafted for comfort and style where timeless design and expert woodworking create the perfect place to gather and unwind.</p>
                </div>
            </div>
            <div class="catalogue-item">
                <div class="catalogue-image" style="background-image: url('https://media.istockphoto.com/id/2045383950/photo/digital-render-of-a-serene-bedroom-oasis-with-natural-light.jpg?s=612x612&w=0&k=20&c=GnifMJfGSUd96PE8rxKRVvnIb-vcwIWIuY783FkcPMk=')"></div>
                <div class="catalogue-content">
                    <span class="collection-tag">Bedroom & Dressing Collections</span>
                    <h3>Your Sanctuary of Serenity</h3>
                    <p>Experience bespoke bedrooms designed for rest and renewal, blending elegant style with smart storage to create a harmonious and peaceful retreat.</p>
                </div>
            </div>
            <div class="catalogue-item">
                <div class="catalogue-image" style="background-image: url('https://media.istockphoto.com/id/907662122/photo/side-white-tile-and-wooden-kitchen-interior-bar.jpg?s=612x612&w=0&k=20&c=uQji4jmIS5ghcQJna4aBTb6MZ5TNdYDuVDCXNiySnRM=')"></div>
                <div class="catalogue-content">
                    <span class="collection-tag">Kitchen Collections</span>
                    <h3>Craftsmanship at the Heart of Your Home</h3>
                    <p>Discover elegant, functional kitchens crafted from premium woods and finishes custom-designed to bring beauty, durability, and harmony to your everyday living.</p>
                </div>
            </div>
            <div class="catalogue-item">
                <div class="catalogue-image" style="background-image: url('img/doors.png')"></div>
                <div class="catalogue-content">
                    <span class="collection-tag">Interior & Entry Doors Collections</span>
                    <h3>The Art of First Impressions</h3>
                    <p>Redefine every entrance with doors that unite craftsmanship, style, and strength creating timeless statements that enhance the character of any space.</p>
                </div>
            </div>
            <div class="catalogue-item">
                <div class="catalogue-image" style="background-image: url('https://media.istockphoto.com/id/1478958694/photo/top-view-on-bright-office-room-interior-with-computers-desks.jpg?s=612x612&w=0&k=20&c=Yl3D1IF0MS4jMk4JjNW6rQANB-3WqXfodVjGmSsKouc=')"></div>
                <div class="catalogue-content">
                    <span class="collection-tag">Workspace Collections</span>
                    <h3>Design That Inspires Productivity</h3>
                    <p>Elevate your workspace with refined wooden furniture that blends ergonomic comfort and timeless design, creating a focused and inspiring environment.</p>
                </div>
            </div>
            <div class="catalogue-item">
                <div class="catalogue-image" style="background-image: url('img/office.png')"></div>
                <div class="catalogue-content">
                    <span class="collection-tag">Office Collections</span>
                    <h3>Executive Leadership Desk</h3>
                    <p>A high-end executive desk with a spacious work surface, integrated side storage, and refined finish.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="pdf-catalogue" id="catalogue">
        <h2 class="section-title">DOWNLOAD OUR CATALOG</h2>
        <p class="pdf-subtitle">Explore our complete collection of wood designs and furniture. Download our detailed catalogue to discover the perfect pieces for your space.</p>

        <div class="pdf-container">
            <div class="pdf-card">
                <span class="pdf-icon">
                    <i class="fas fa-file-pdf"></i>
                </span>
                <h3>ARCHIKMOR Catalog 2026</h3>
                <p>Immerse yourself in curated living, kitchen, workspace, and architectural wood collections designed to bring harmony to every interior.</p>

                <div class="pdf-details">
                    <p><i class="fas fa-layer-group"></i> 6 signature collections</p>
                    <p><i class="fas fa-ruler-combined"></i> Detailed specifications & finishes</p>
                    <p><i class="fas fa-images"></i> High-resolution project imagery</p>
                </div>

                <div class="mobile-download-message" id="mobileMessage">
                    Download on desktop for the best experience, or request the catalogue via email.
                </div>

                <div class="download-options">
                    <a href="catalogue/Archikmor-Catalogue2026.pdf" class="download-btn" id="directDownload" download="Archikmor-Catalogue2026.pdf">
                        <i class="fas fa-download"></i> Download Full Catalog
                    </a>
                    <a href="#preview" class="preview-btn" id="previewLink">
                        <i class="fas fa-eye"></i> Preview Collections
                    </a>
                </div>

                <div class="email-request-form">
                    <h4>Prefer Email Delivery?</h4>
                    <p>If you're having trouble downloading, we can send the catalog directly to your inbox.</p>
                    <div class="email-form-group">
                        <input type="email" id="emailInput" placeholder="Your email address" required>
                        <button class="email-submit-btn" id="emailRequestBtn">Send Catalog</button>
                    </div>
                    <div class="form-status email-request-status" id="emailRequestStatus" role="status" aria-live="polite" hidden></div>
                </div>
            </div>
        </div>

        <div class="help-section">
            <h3>Your Dream Project Starts Here</h3>
            <p>Share your vision with us and let’s bring it to life. Whether you’re imagining a new home, a unique interior, or a full architectural concept, we’re here to listen. Describe your ideas, your needs, and your style.Our team will guide you through every step to turn your dream project into a beautifully crafted reality just contact us:</p>
            <div class="contact-info">
                <span class="contact-line">Sales@archikmor.com</span>
                <span class="contact-line">+212 783101423</span>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="services" id="services">
        <h2 class="section-title">OUR SERVICES</h2>
        <div class="services-grid">
            <div class="service-card">
                <div class="service-image" style="background-image: url('https://plus.unsplash.com/premium_photo-1661962340349-6ea59fff7e7b?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDN8fHxlbnwwfHx8fHw%3D&auto=format&fit=crop&q=60&w=600')"></div>
                <div class="service-content">
                    <h3>Interior Design</h3>
                    <p>Complete interior design solutions from concept to execution, creating harmonious spaces that reflect your personality and lifestyle.</p>
                </div>
            </div>
            <div class="service-card">
                <div class="service-image" style="background-image: url('https://plus.unsplash.com/premium_photo-1670076515866-73822a3d610d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1170')"></div>
                <div class="service-content">
                    <h3>Custom Furniture</h3>
                    <p>Bespoke furniture design and craftsmanship, creating unique pieces that perfectly fit your space and style.</p>
                </div>
            </div>
            <div class="service-card">
                <div class="service-image" style="background-image: url('/img/planing.png')"></div>
                <div class="service-content">
                    <h3>Space Planning</h3>
                    <p>Strategic space optimization and layout design to maximize functionality while maintaining aesthetic appeal and flow.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="contact" id="contact">
        <h2 class="section-title">READY TO CREATE YOUR SPACE?</h2>
        <div class="contact-grid">
            <div class="contact-info">
                <h3>Start Your Journey</h3>
                <div class="contact-details">
                    <p><i class="fas fa-map-marker-alt"></i> KM 11 600 BD CHEFCHAOUNI Q I SIDI BERSNOUSSI, CHEZ BN BRAHIM IMMOBILIER, Casablanca</p>
                    <p><i class="fas fa-phone"></i> +212 783101423</p>
                    <p><i class="fas fa-envelope"></i> Sales@archikmor.com</p>
                    <p><i class="fas fa-clock"></i> Mon - Fri: 8AM - 6PM</p>
                </div>
                
                <!-- السوشيال ميديا المُصلحة -->
                <div class="social-section">
                    <h4 class="social-title">CONNECT WITH US</h4>
                    <div class="social-links">
                        <a href="https://www.facebook.com/share/19uU8Jr3gz/" target="_blank" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://www.instagram.com/archikmor?igsh=eTV5NGI2b2lldzc2" target="_blank" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://www.tiktok.com/@archikmor?_r=1&_t=ZS-91Cbo0aFzM2" target="_blank" title="TikTok">
                            <i class="fab fa-tiktok"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="contact-form">
                <form id="contactForm" novalidate>
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" name="name" placeholder="Your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="project">Project Type</label>
                        <input type="text" id="project" name="project" placeholder="Residential, Commercial, etc.">
                    </div>
                    <div class="form-group">
                        <label for="message">Project Details</label>
                        <textarea id="message" name="message" placeholder="Tell us about your space and vision..." required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Begin Your Transformation</button>
                    <div class="form-status" id="contactStatus" role="status" aria-live="polite" hidden></div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">ARCHIKMOR</div>
            <div class="footer-tagline">Where Design Meets Harmony</div>
            
            <!-- السوشيال ميديا في الفوتر المُصلحة -->
            <div class="social-links" style="justify-content: center; margin-bottom: 30px;">
                <a href="https://www.facebook.com/share/1Dk1u67RN5/" target="_blank" title="Facebook">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://www.instagram.com/archikmor?igsh=MXY4OW9oMjEzZXo0dw==" target="_blank" title="Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://www.tiktok.com/@archikmor?_r=1&_t=ZS-917PmUAqhAv" target="_blank" title="TikTok">
                    <i class="fab fa-tiktok"></i>
                </a>
            </div>
            
            <div class="footer-links">
                <a href="#home">Home</a>
                <a href="#planning">Space Planning</a>
                <a href="#wood">Wood Craft</a>
                <a href="#catalogue">Catalog</a>
                <a href="#preview">Preview</a>
                <a href="#services">Services</a>
                <a href="#contact">Contact</a>
            </div>
            <div class="footer-bottom">
                © 2025 ARCHIKMOR. Crafting timeless spaces with wood, wisdom, and harmony.
            </div>
        </div>
    </footer>

    <!-- Newsletter Modal -->
    <div class="newsletter-modal" id="newsletterModal" role="dialog" aria-modal="true" aria-labelledby="newsletterHeading" aria-describedby="newsletterDescription" hidden>
        <div class="newsletter-overlay" data-close="true"></div>
        <div class="newsletter-card" role="document">
            <button class="newsletter-close" type="button" aria-label="Close newsletter sign-up" data-close="true">
                <i class="fa-solid fa-xmark"></i>
            </button>
            <div class="newsletter-content">
                <p class="newsletter-tagline">Exclusive insights, timeless spaces</p>
                <h2 id="newsletterHeading">Stay in Archikmor’s Harmony</h2>
                <p id="newsletterDescription">Subscribe for curated inspiration, project reveals, and members-only offers handpicked by our design studio.</p>
                <form class="newsletter-form" id="newsletterForm">
                    <label class="newsletter-field">
                        <span>Name</span>
                        <input type="text" name="name" autocomplete="name" required>
                    </label>
                    <label class="newsletter-field">
                        <span>Email</span>
                        <input type="email" name="email" autocomplete="email" required>
                    </label>
                    <button class="newsletter-submit" type="submit">Subscribe</button>
                    <div class="form-status newsletter-status" id="newsletterStatus" role="status" aria-live="polite" hidden></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Download Notification -->
    <div class="download-notification" id="downloadNotification">
        <span>Download started! Check your downloads folder.</span>
        <button class="close-btn" id="closeNotification">✕</button>
    </div>

    <script>
        // Header transparency effect
        window.addEventListener('scroll', function() {
            const header = document.getElementById('header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Mobile navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileNav = document.getElementById('mobileNav');
            const mobileNavClose = document.getElementById('mobileNavClose');
            const mobileNavOverlay = document.getElementById('mobileNavOverlay');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
            const mobileMessage = document.getElementById('mobileMessage');
            const directDownload = document.getElementById('directDownload');
            const downloadNotification = document.getElementById('downloadNotification');
            const closeNotification = document.getElementById('closeNotification');
            const emailRequestBtn = document.getElementById('emailRequestBtn');
            const emailInput = document.getElementById('emailInput');
            const contactForm = document.getElementById('contactForm');
            const contactStatus = document.getElementById('contactStatus');
            const contactSubmitBtn = contactForm?.querySelector('.submit-btn');
            const defaultSubmitText = contactSubmitBtn?.textContent?.trim() ?? 'Begin Your Transformation';
            // Dynamic API URL - works on localhost and network access
            const API_BASE_URL = (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1')
                ? 'http://localhost:3004'
                : `http://${window.location.hostname}:3004`;
            window.__ARCHIKMOR_API__ = API_BASE_URL;

            const hasCoreNavElements = mobileMenuBtn && mobileNav && mobileNavClose && mobileNavOverlay;
            if (!hasCoreNavElements) {
                console.warn('ARCHIKMOR: Missing navigation elements – skipping interactive bindings.');
                return;
            }

            // كشف إذا كان المستخدم على هاتف محمول
            function isMobileDevice() {
                return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            }
            
            // إظهار رسالة للمستخدمين على الهواتف
            if (mobileMessage && isMobileDevice()) {
                mobileMessage.style.display = 'block';
            }
            
            // فتح القائمة
            mobileMenuBtn.addEventListener('click', function() {
                mobileNav.classList.add('active');
                mobileNavOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            });
            
            // إغلاق القائمة
            function closeMobileNav() {
                mobileNav.classList.remove('active');
                mobileNavOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            mobileNavClose.addEventListener('click', closeMobileNav);
            mobileNavOverlay.addEventListener('click', closeMobileNav);
            
            // إغلاق القائمة عند النقر على رابط
            mobileNavLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    
                    closeMobileNav();
                    
                    // الانتقال السلس للقسم المطلوب
                    setTimeout(() => {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                        }
                    }, 300);
                });
            });

            // إظهار إشعار التحميل
            function showDownloadNotification() {
                if (!downloadNotification) return;
                downloadNotification.classList.add('show');
                setTimeout(() => {
                    downloadNotification.classList.remove('show');
                }, 5000);
            }

            // إغلاق إشعار التحميل
            if (closeNotification && downloadNotification) {
                closeNotification.addEventListener('click', function() {
                    downloadNotification.classList.remove('show');
                });
            }

            // التحقق من وجود ملف PDF
            function checkPDFExists(url, callback) {
                const xhr = new XMLHttpRequest();
                xhr.open('HEAD', url, true);
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        callback(xhr.status === 200);
                    }
                };
                xhr.send();
            }

            const emailRequestStatus = document.getElementById('emailRequestStatus');
            if (emailRequestBtn && emailInput) {
                // Handle email catalogue request
                emailRequestBtn.addEventListener('click', async function() {
                    const email = emailInput.value.trim();
                    
                    if (!email) {
                        updateEmailRequestStatus('Please enter your email address.', 'error');
                        return;
                    }
                    
                    if (!isValidEmail(email)) {
                        updateEmailRequestStatus('Please enter a valid email address.', 'error');
                        return;
                    }

                    // Disable button and show loading state
                    emailRequestBtn.disabled = true;
                    const originalText = emailRequestBtn.textContent;
                    emailRequestBtn.textContent = 'Sending...';
                    updateEmailRequestStatus('Sending catalogue to your email...', 'pending');

                    try {
                        const response = await fetch(`${API_BASE_URL}/api/catalogue/email`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ email }),
                        });

                        const responseBody = await response.json().catch(() => ({}));

                        if (!response.ok) {
                            throw new Error(responseBody.error || 'Unable to send catalogue email right now.');
                        }

                        emailInput.value = '';
                        updateEmailRequestStatus(responseBody.message || 'Catalogue sent successfully! Please check your email inbox.', 'success');
                    } catch (error) {
                        console.error('ARCHIKMOR catalogue email request failed:', error);
                        updateEmailRequestStatus(error.message || 'Something went wrong. Please try again later.', 'error');
                    } finally {
                        emailRequestBtn.disabled = false;
                        emailRequestBtn.textContent = originalText;
                    }
                });
            }

            function updateEmailRequestStatus(message, status) {
                if (!emailRequestStatus) return;
                emailRequestStatus.textContent = message;
                emailRequestStatus.dataset.status = status;
                emailRequestStatus.hidden = false;
            }

            // التحقق من صحة البريد الإلكتروني
            function isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            if (directDownload) {
                // Handle catalogue download via API endpoint
                directDownload.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const downloadUrl = API_BASE_URL 
                        ? `${API_BASE_URL}/api/catalogue/download`
                        : 'catalogue/Archikmor-Catalogue2026.pdf';
                    
                    // Try API endpoint first, fallback to static file
                    if (API_BASE_URL) {
                        // Use API endpoint for tracking
                        fetch(downloadUrl)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Download failed');
                                }
                                return response.blob();
                            })
                            .then(blob => {
                                const url = window.URL.createObjectURL(blob);
                                const a = document.createElement('a');
                                a.href = url;
                                a.download = 'Archikmor-Catalogue2026.pdf';
                                document.body.appendChild(a);
                                a.click();
                                window.URL.revokeObjectURL(url);
                                document.body.removeChild(a);
                                showDownloadNotification();
                            })
                            .catch(error => {
                                console.error('API download failed, trying static file:', error);
                                // Fallback to static file
                                window.location.href = 'catalogue/Archikmor-Catalogue2026.pdf';
                                showDownloadNotification();
                            });
                    } else {
                        // No API available, use static file
                        window.location.href = downloadUrl;
                        showDownloadNotification();
                    }
                });
            }

            if (contactForm && contactSubmitBtn) {
                contactForm.addEventListener('submit', async function(event) {
                    event.preventDefault();

                    const formData = new FormData(contactForm);
                    const payload = {
                        name: formData.get('name')?.toString().trim() ?? '',
                        email: formData.get('email')?.toString().trim() ?? '',
                        project: formData.get('project')?.toString().trim() ?? '',
                        message: formData.get('message')?.toString().trim() ?? '',
                    };

                    if (!payload.name || !payload.email || !payload.message) {
                        updateContactStatus('Please complete your name, email, and project details before submitting.', 'error');
                        return;
                    }

                    toggleContactSubmitting(true);
                    updateContactStatus('Sending your request...', 'pending');

                    try {
                        const response = await fetch(`${API_BASE_URL}/api/contact`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(payload),
                        });

                        const responseBody = await response.json().catch(() => ({}));
                        if (!response.ok) {
                            throw new Error(responseBody.error || 'Unable to submit your request right now.');
                        }

                        contactForm.reset();
                        updateContactStatus(responseBody.message || 'Thank you for reaching out! Our team will connect with you shortly.', 'success');
                    } catch (error) {
                        console.error('ARCHIKMOR contact submission failed:', error);
                        updateContactStatus(error.message || 'Something went wrong. Please try again later.', 'error');
                    } finally {
                        toggleContactSubmitting(false);
                    }
                });
            }

            function toggleContactSubmitting(isSubmitting) {
                contactSubmitBtn.disabled = isSubmitting;
                contactSubmitBtn.textContent = isSubmitting ? 'Sending...' : defaultSubmitText;
            }

            function updateContactStatus(message, status) {
                if (!contactStatus) return;
                contactStatus.textContent = message;
                contactStatus.dataset.status = status;
                contactStatus.hidden = false;
            }
        });
    </script>
    <script>
        (function() {
            const modal = document.getElementById('newsletterModal');
            const card = modal?.querySelector('.newsletter-card');
            const closeTriggers = modal?.querySelectorAll('[data-close]');
            const focusableSelector = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
            let previouslyFocused = null;
            const form = document.getElementById('newsletterForm');
            const newsletterStatus = document.getElementById('newsletterStatus');
            const newsletterSubmitBtn = form?.querySelector('.newsletter-submit');
            const defaultNewsletterText = newsletterSubmitBtn?.textContent?.trim() ?? 'Subscribe';
            // Dynamic API URL - works on localhost and network access
            const API_BASE_URL = window.__ARCHIKMOR_API__ ?? ((window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1')
                ? 'http://localhost:3004'
                : `http://${window.location.hostname}:3004`);

            if (!modal || !card) return;

            const openModal = () => {
                previouslyFocused = document.activeElement;
                resetNewsletterState();
                modal.hidden = false;
                requestAnimationFrame(() => modal.classList.add('active'));
                const firstFocusable = card.querySelector(focusableSelector);
                firstFocusable?.focus();
                document.body.style.overflow = 'hidden';
                document.addEventListener('keydown', handleKeydown);
            };

            const closeModal = () => {
                modal.classList.remove('active');
                const handleTransitionEnd = () => {
                    modal.hidden = true;
                    modal.removeEventListener('transitionend', handleTransitionEnd);
                };
                modal.addEventListener('transitionend', handleTransitionEnd);
                document.body.style.overflow = '';
                document.removeEventListener('keydown', handleKeydown);
                previouslyFocused?.focus();
                resetNewsletterState();
            };

            function resetNewsletterState() {
                if (newsletterStatus) {
                    newsletterStatus.hidden = true;
                    newsletterStatus.textContent = '';
                    delete newsletterStatus.dataset.status;
                }

                if (newsletterSubmitBtn) {
                    newsletterSubmitBtn.disabled = false;
                    newsletterSubmitBtn.textContent = defaultNewsletterText;
                }
            }

            function toggleNewsletterSubmitting(isSubmitting) {
                if (!newsletterSubmitBtn) return;
                newsletterSubmitBtn.disabled = isSubmitting;
                newsletterSubmitBtn.textContent = isSubmitting ? 'Subscribing...' : defaultNewsletterText;
            }

            function updateNewsletterStatus(message, status) {
                if (!newsletterStatus) return;
                newsletterStatus.textContent = message;
                newsletterStatus.dataset.status = status;
                newsletterStatus.hidden = false;
            }

            function isValidNewsletterEmail(email) {
                return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
            }

            const handleKeydown = (event) => {
                if (event.key === 'Escape') {
                    closeModal();
                } else if (event.key === 'Tab') {
                    trapFocus(event);
                }
            };

            const trapFocus = (event) => {
                const focusable = card.querySelectorAll(focusableSelector);
                if (!focusable.length) return;
                const first = focusable[0];
                const last = focusable[focusable.length - 1];

                if (event.shiftKey && document.activeElement === first) {
                    event.preventDefault();
                    last.focus();
                } else if (!event.shiftKey && document.activeElement === last) {
                    event.preventDefault();
                    first.focus();
                }
            };

            closeTriggers?.forEach(trigger => trigger.addEventListener('click', closeModal));

            modal.addEventListener('click', (event) => {
                if (event.target.dataset.close) {
                    closeModal();
                }
            });

            card.addEventListener('click', (event) => event.stopPropagation());

            window.addEventListener('DOMContentLoaded', () => {
                setTimeout(openModal, 6000);

                const manualTriggers = document.querySelectorAll('[data-open-newsletter]');
                manualTriggers.forEach(trigger => trigger.addEventListener('click', openModal));
            });

            form?.addEventListener('submit', async (event) => {
                event.preventDefault();
                if (!form) return;

                const formData = new FormData(form);
                const payload = {
                    name: formData.get('name')?.toString().trim() ?? '',
                    email: formData.get('email')?.toString().trim() ?? '',
                };

                if (!payload.email) {
                    updateNewsletterStatus('Please enter your email address.', 'error');
                    return;
                }

                if (!isValidNewsletterEmail(payload.email)) {
                    updateNewsletterStatus('Please provide a valid email address.', 'error');
                    return;
                }

                toggleNewsletterSubmitting(true);
                updateNewsletterStatus('Adding you to our list...', 'pending');

                try {
                    const response = await fetch(`${API_BASE_URL}/api/newsletter`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload),
                    });

                    const responseBody = await response.json().catch(() => ({}));

                    if (!response.ok) {
                        throw new Error(responseBody.error || 'Unable to subscribe right now.');
                    }

                    form.reset();
                    updateNewsletterStatus(responseBody.message || 'You are now subscribed!', 'success');
                    setTimeout(() => closeModal(), 1500);
                } catch (error) {
                    console.error('ARCHIKMOR newsletter subscription failed:', error);
                    updateNewsletterStatus(error.message || 'Something went wrong. Please try again later.', 'error');
                } finally {
                    toggleNewsletterSubmitting(false);
                }
            });
        })();
    </script>
</body>
</html>